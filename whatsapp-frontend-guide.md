# Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ Ú©Ø§Ù…Ù„ WhatsApp Ø¨Ø±Ø§ÛŒ ÙØ±Ø§Ù†Øªâ€ŒØ§Ù†Ø¯ - Spirithub Cafe

## ÙÙ‡Ø±Ø³Øª Ù…Ø·Ø§Ù„Ø¨

1. [ÙˆØ±ÙˆØ¯ Ùˆ Ø¹Ø¶ÙˆÛŒØª Ø¨Ø§ Ø´Ù…Ø§Ø±Ù‡ Ù…ÙˆØ¨Ø§ÛŒÙ„ (OTP)](#1-ÙˆØ±ÙˆØ¯-Ùˆ-Ø¹Ø¶ÙˆÛŒØª-Ø¨Ø§-Ø´Ù…Ø§Ø±Ù‡-Ù…ÙˆØ¨Ø§ÛŒÙ„-otp)
2. [Ø§Ø±Ø³Ø§Ù„ Ù¾ÛŒØ§Ù… Ùˆ Ø¹Ú©Ø³ ØªÙˆØ³Ø· Ø§Ø¯Ù…ÛŒÙ†](#2-Ø§Ø±Ø³Ø§Ù„-Ù¾ÛŒØ§Ù…-Ùˆ-Ø¹Ú©Ø³-ØªÙˆØ³Ø·-Ø§Ø¯Ù…ÛŒÙ†)
3. [ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ù†ÙˆØªÛŒÙÛŒÚ©ÛŒØ´Ù† ÙˆØ§ØªØ³â€ŒØ§Ù¾](#3-ØªÙ†Ø¸ÛŒÙ…Ø§Øª-Ù†ÙˆØªÛŒÙÛŒÚ©ÛŒØ´Ù†-ÙˆØ§ØªØ³â€ŒØ§Ù¾)
4. [Types Ùˆ Interfaces](#4-types-Ùˆ-interfaces)
5. [Ú©Ø§Ù…Ù¾ÙˆÙ†Ù†Øªâ€ŒÙ‡Ø§ÛŒ React](#5-Ú©Ø§Ù…Ù¾ÙˆÙ†Ù†Øªâ€ŒÙ‡Ø§ÛŒ-react)
6. [Hooks Ø³ÙØ§Ø±Ø´ÛŒ](#6-hooks-Ø³ÙØ§Ø±Ø´ÛŒ)
7. [Ù…Ø¯ÛŒØ±ÛŒØª Ø®Ø·Ø§Ù‡Ø§](#7-Ù…Ø¯ÛŒØ±ÛŒØª-Ø®Ø·Ø§Ù‡Ø§)

---

## 1. ÙˆØ±ÙˆØ¯ Ùˆ Ø¹Ø¶ÙˆÛŒØª Ø¨Ø§ Ø´Ù…Ø§Ø±Ù‡ Ù…ÙˆØ¨Ø§ÛŒÙ„ (OTP)

### ØªÙˆØ¶ÛŒØ­Ø§Øª
- Ú©Ø§Ø±Ø¨Ø± **ÙÙ‚Ø· Ø´Ù…Ø§Ø±Ù‡ Ù…ÙˆØ¨Ø§ÛŒÙ„** ÙˆØ§Ø±Ø¯ Ù…ÛŒâ€ŒÚ©Ù†Ø¯ (Ø¨Ø¯ÙˆÙ† Ø±Ù…Ø² Ø¹Ø¨ÙˆØ±)
- Ø³ÛŒØ³ØªÙ… OTP Ø´Ø´â€ŒØ±Ù‚Ù…ÛŒ Ø¨Ù‡ ÙˆØ§ØªØ³â€ŒØ§Ù¾ Ø§Ø±Ø³Ø§Ù„ Ù…ÛŒâ€ŒÚ©Ù†Ø¯
- Ø§Ú¯Ø± Ú©Ø§Ø±Ø¨Ø± Ø¬Ø¯ÛŒØ¯ Ø¨Ø§Ø´Ø¯ØŒ **Ø®ÙˆØ¯Ú©Ø§Ø± Ø«Ø¨Øªâ€ŒÙ†Ø§Ù…** Ù…ÛŒâ€ŒØ´ÙˆØ¯
- Ø§Ú¯Ø± Ú©Ø§Ø±Ø¨Ø± Ù‚Ø¨Ù„ÛŒ Ø¨Ø§Ø´Ø¯ØŒ ÙˆØ§Ø±Ø¯ Ù…ÛŒâ€ŒØ´ÙˆØ¯
- OTP Ù¾Ù†Ø¬ Ø¯Ù‚ÛŒÙ‚Ù‡ Ø§Ø¹ØªØ¨Ø§Ø± Ø¯Ø§Ø±Ø¯
- Ø­Ø¯Ø§Ù‚Ù„ Û¶Û° Ø«Ø§Ù†ÛŒÙ‡ ÙØ§ØµÙ„Ù‡ Ø¨ÛŒÙ† Ø¯Ø±Ø®ÙˆØ§Ø³Øªâ€ŒÙ‡Ø§ÛŒ OTP
- Ø­Ø¯Ø§Ú©Ø«Ø± Ûµ ØªÙ„Ø§Ø´ Ø¨Ø±Ø§ÛŒ ÙˆØ§Ø±Ø¯ Ú©Ø±Ø¯Ù† OTP

### API Endpoints

#### 1.1 Ø¯Ø±Ø®ÙˆØ§Ø³Øª OTP

```http
POST /api/account/phone-otp/request
Content-Type: application/json

{
  "phoneNumber": "92506030"  // ÛŒØ§ "96892506030" ÛŒØ§ "+96892506030"
}
```

**Response - Ù…ÙˆÙÙ‚:**
```json
{
  "success": true,
  "message": "OTP sent successfully",
  "isNewUser": false  // true Ø§Ú¯Ø± Ú©Ø§Ø±Ø¨Ø± Ø¬Ø¯ÛŒØ¯ Ø¨Ø§Ø´Ø¯
}
```

**Response - Ø®Ø·Ø§:**
```json
{
  "success": false,
  "error": "Please wait 45 seconds before requesting another OTP"
}
```

#### 1.2 ØªØ§ÛŒÛŒØ¯ OTP Ùˆ ÙˆØ±ÙˆØ¯

```http
POST /api/account/phone-otp/verify
Content-Type: application/json

{
  "phoneNumber": "92506030",
  "code": "123456"
}
```

**Response - Ù…ÙˆÙÙ‚:**
```json
{
  "success": true,
  "message": "Login successful",
  "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "refresh_token": "abc123...",
  "user": {
    "id": 123,
    "username": "96892506030",
    "displayName": "96892506030",
    "phoneNumber": "96892506030",
    "phoneVerified": true,
    "email": null
  }
}
```

**Response - Ø®Ø·Ø§:**
```json
{
  "success": false,
  "error": "Invalid OTP. 3 attempts remaining"
}
```

### ÙØ±Ù…Øª Ø´Ù…Ø§Ø±Ù‡ Ù…ÙˆØ¨Ø§ÛŒÙ„
Ø³ÛŒØ³ØªÙ… Ø§ÛŒÙ† ÙØ±Ù…Øªâ€ŒÙ‡Ø§ Ø±Ø§ Ù‚Ø¨ÙˆÙ„ Ù…ÛŒâ€ŒÚ©Ù†Ø¯:
- `92506030` - Ø´Ù…Ø§Ø±Ù‡ Û¸ Ø±Ù‚Ù…ÛŒ Ø¹Ù…Ø§Ù†
- `96892506030` - Ø¨Ø§ Ú©Ø¯ Ú©Ø´ÙˆØ±
- `+96892506030` - Ø¨Ø§ + Ùˆ Ú©Ø¯ Ú©Ø´ÙˆØ±

Ù‡Ù…Ù‡ Ø¨Ù‡ ÙØ±Ù…Øª `96892506030` Ù†Ø±Ù…Ø§Ù„â€ŒØ³Ø§Ø²ÛŒ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯.

---

## 2. Ø§Ø±Ø³Ø§Ù„ Ù¾ÛŒØ§Ù… Ùˆ Ø¹Ú©Ø³ ØªÙˆØ³Ø· Ø§Ø¯Ù…ÛŒÙ†

### 2.1 Ø§Ø±Ø³Ø§Ù„ Ù¾ÛŒØ§Ù… Ù…ØªÙ†ÛŒ

```http
POST /api/whatsapp/send
Authorization: Bearer {token}
Content-Type: application/json

{
  "phoneNumber": "92506030",
  "message": "Ø³Ù„Ø§Ù…! Ø³ÙØ§Ø±Ø´ Ø´Ù…Ø§ Ø¢Ù…Ø§Ø¯Ù‡ Ø§Ø±Ø³Ø§Ù„ Ø§Ø³Øª. ğŸ‰"
}
```

**Response:**
```json
{
  "success": true,
  "message": "WhatsApp message sent"
}
```

### 2.2 Ø§Ø±Ø³Ø§Ù„ Ø¹Ú©Ø³ Ø¨Ø§ Ú©Ù¾Ø´Ù†

```http
POST /api/whatsapp/send-image
Authorization: Bearer {token}
Content-Type: application/json

{
  "phoneNumber": "92506030",
  "imageUrl": "https://spirithubcafe.com/images/products/coffee.jpg",
  "caption": "Ù…Ø­ØµÙˆÙ„ Ø¬Ø¯ÛŒØ¯ Ù…Ø§! â˜•"
}
```

**Response:**
```json
{
  "success": true,
  "message": "WhatsApp image sent"
}
```

### Ù†Ú©Ø§Øª Ù…Ù‡Ù…
- Ø§ÛŒÙ† endpointâ€ŒÙ‡Ø§ Ù†ÛŒØ§Ø² Ø¨Ù‡ **Ø¯Ø³ØªØ±Ø³ÛŒ Ø§Ø¯Ù…ÛŒÙ†** Ø¯Ø§Ø±Ù†Ø¯
- `imageUrl` Ø¨Ø§ÛŒØ¯ ÛŒÚ© URL Ù…Ø¹ØªØ¨Ø± Ùˆ Ù‚Ø§Ø¨Ù„ Ø¯Ø³ØªØ±Ø³ÛŒ Ø¨Ø§Ø´Ø¯
- `caption` Ø§Ø®ØªÛŒØ§Ø±ÛŒ Ø§Ø³Øª

---

## 3. ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ù†ÙˆØªÛŒÙÛŒÚ©ÛŒØ´Ù† ÙˆØ§ØªØ³â€ŒØ§Ù¾ (Ø¬Ø¯Ø§Ú¯Ø§Ù†Ù‡)

> âš ï¸ **ØªÙˆØ¬Ù‡**: ØªÙ†Ø¸ÛŒÙ…Ø§Øª ÙˆØ§ØªØ³â€ŒØ§Ù¾ Ø§Ø² Ø§ÛŒÙ…ÛŒÙ„ **Ú©Ø§Ù…Ù„Ø§Ù‹ Ø¬Ø¯Ø§** Ø´Ø¯Ù‡ Ùˆ endpoint Ù…Ø®ØªØµ Ø®ÙˆØ¯Ø´ Ø±Ø§ Ø¯Ø§Ø±Ø¯.

### 3.1 Ø¯Ø±ÛŒØ§ÙØª ØªÙ†Ø¸ÛŒÙ…Ø§Øª ÙˆØ§ØªØ³â€ŒØ§Ù¾

```http
GET /api/whatsapp-notification-settings
Authorization: Bearer {token}
```

**Response:**
```json
{
  "success": true,
  "data": {
    "id": 1,
    "isEnabled": true,
    "adminNumbers": "96892506030,96899999999",
    "supportNumber": "96892506030",
    
    "customerOrderPlacedEnabled": true,
    "customerOrderStatusChangedEnabled": true,
    "customerPaymentStatusChangedEnabled": true,
    "customerShippingUpdateEnabled": true,
    "customerOrderCancelledEnabled": true,
    "customerWelcomeEnabled": true,
    "customerLoginSuccessEnabled": false,
    "customerPasswordResetEnabled": true,
    "customerPasswordChangedEnabled": true,
    "customerOtpEnabled": true,
    
    "adminNewOrderEnabled": true,
    "adminPaymentReceivedEnabled": true,
    "adminOrderStatusChangedEnabled": true,
    "adminLowStockEnabled": true,
    "adminNewUserEnabled": true,
    
    "createdAt": "2026-02-08T10:00:00Z",
    "updatedAt": "2026-02-08T12:00:00Z"
  }
}
```

### 3.2 Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ ØªÙ†Ø¸ÛŒÙ…Ø§Øª ÙˆØ§ØªØ³â€ŒØ§Ù¾

```http
PUT /api/whatsapp-notification-settings
Authorization: Bearer {token}
Content-Type: application/json

{
  "isEnabled": true,
  "adminNumbers": "96892506030",
  "supportNumber": "96892506030",
  
  "customerOrderPlacedEnabled": true,
  "customerOrderStatusChangedEnabled": true,
  "customerPaymentStatusChangedEnabled": true,
  "customerShippingUpdateEnabled": true,
  "customerOrderCancelledEnabled": true,
  "customerWelcomeEnabled": true,
  "customerLoginSuccessEnabled": false,
  "customerPasswordResetEnabled": true,
  "customerPasswordChangedEnabled": true,
  "customerOtpEnabled": true,
  
  "adminNewOrderEnabled": true,
  "adminPaymentReceivedEnabled": true,
  "adminOrderStatusChangedEnabled": true,
  "adminLowStockEnabled": true,
  "adminNewUserEnabled": true
}
```

### 3.3 ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø§ÛŒÙ…ÛŒÙ„ (Ø¬Ø¯Ø§Ú¯Ø§Ù†Ù‡)

```http
GET /api/email-notification-settings
PUT /api/email-notification-settings
```

Ø§ÛŒÙ† endpoint ÙÙ‚Ø· Ø¨Ø±Ø§ÛŒ ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø§ÛŒÙ…ÛŒÙ„ Ø§Ø³Øª Ùˆ Ø´Ø§Ù…Ù„ ÙÛŒÙ„Ø¯Ù‡Ø§ÛŒ ÙˆØ§ØªØ³â€ŒØ§Ù¾ Ù†ÛŒØ³Øª.

---

## 4. Types Ùˆ Interfaces

```typescript
// ==================== Phone OTP Types ====================

interface PhoneOtpRequestDto {
  phoneNumber: string;
}

interface PhoneOtpVerifyDto {
  phoneNumber: string;
  code: string;
}

interface PhoneOtpRequestResponse {
  success: boolean;
  message: string;
  isNewUser?: boolean;
  error?: string;
}

interface PhoneOtpVerifyResponse {
  success: boolean;
  message: string;
  access_token?: string;
  refresh_token?: string;
  user?: {
    id: number;
    username: string;
    displayName: string;
    phoneNumber: string;
    phoneVerified: boolean;
    email: string | null;
  };
  error?: string;
}

// ==================== WhatsApp Send Types ====================

interface WhatsAppSendDto {
  phoneNumber: string;
  message: string;
}

interface WhatsAppSendImageDto {
  phoneNumber: string;
  imageUrl: string;
  caption?: string;
}

interface WhatsAppSendResponse {
  success: boolean;
  message: string;
}

// ==================== WhatsApp Notification Settings Types ====================

interface WhatsAppNotificationSettingsDto {
  // Master switch
  isEnabled: boolean;
  
  // Recipients
  adminNumbers: string | null;
  supportNumber: string | null;
  
  // Customer notifications
  customerOrderPlacedEnabled: boolean;
  customerOrderStatusChangedEnabled: boolean;
  customerPaymentStatusChangedEnabled: boolean;
  customerShippingUpdateEnabled: boolean;
  customerOrderCancelledEnabled: boolean;
  customerWelcomeEnabled: boolean;
  customerLoginSuccessEnabled: boolean;
  customerPasswordResetEnabled: boolean;
  customerPasswordChangedEnabled: boolean;
  customerOtpEnabled: boolean;
  
  // Admin notifications
  adminNewOrderEnabled: boolean;
  adminPaymentReceivedEnabled: boolean;
  adminOrderStatusChangedEnabled: boolean;
  adminLowStockEnabled: boolean;
  adminNewUserEnabled: boolean;
}

interface WhatsAppNotificationSettingsResponse extends WhatsAppNotificationSettingsDto {
  id: number;
  createdAt: string;
  updatedAt: string;
}

// ==================== Email Notification Settings Types (Separate) ====================

interface EmailNotificationSettingsDto {
  isEnabled: boolean;
  adminEmails: string | null;
  supportEmail: string | null;
  
  customerOrderPlacedEnabled: boolean;
  customerOrderStatusChangedEnabled: boolean;
  customerPaymentStatusChangedEnabled: boolean;
  customerShippingUpdateEnabled: boolean;
  customerOrderCancelledEnabled: boolean;
  customerWelcomeEnabled: boolean;
  customerLoginSuccessEnabled: boolean;
  customerPasswordResetEnabled: boolean;
  customerPasswordChangedEnabled: boolean;
  
  adminNewOrderEnabled: boolean;
  adminPaymentReceivedEnabled: boolean;
  adminOrderStatusChangedEnabled: boolean;
}

interface EmailNotificationSettingsResponse extends EmailNotificationSettingsDto {
  id: number;
  createdAt: string;
  updatedAt: string;
}
```

---

## 5. Ú©Ø§Ù…Ù¾ÙˆÙ†Ù†Øªâ€ŒÙ‡Ø§ÛŒ React

### 5.1 ØµÙØ­Ù‡ ÙˆØ±ÙˆØ¯ Ø¨Ø§ Ø´Ù…Ø§Ø±Ù‡ Ù…ÙˆØ¨Ø§ÛŒÙ„

```tsx
// pages/PhoneLogin.tsx
import React, { useState, useEffect } from 'react';
import { useNavigate } from 'react-router-dom';
import { useAuth } from '../hooks/useAuth';

type Step = 'phone' | 'otp';

export const PhoneLogin: React.FC = () => {
  const [step, setStep] = useState<Step>('phone');
  const [phoneNumber, setPhoneNumber] = useState('');
  const [otpCode, setOtpCode] = useState('');
  const [isNewUser, setIsNewUser] = useState(false);
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState('');
  const [countdown, setCountdown] = useState(0);
  
  const navigate = useNavigate();
  const { login } = useAuth();

  // Countdown timer for resend
  useEffect(() => {
    if (countdown > 0) {
      const timer = setTimeout(() => setCountdown(countdown - 1), 1000);
      return () => clearTimeout(timer);
    }
  }, [countdown]);

  const formatPhoneDisplay = (phone: string) => {
    const digits = phone.replace(/\D/g, '');
    if (digits.length === 8) {
      return `+968 ${digits.slice(0, 4)} ${digits.slice(4)}`;
    }
    return phone;
  };

  const handleRequestOtp = async (e: React.FormEvent) => {
    e.preventDefault();
    setError('');
    setLoading(true);

    try {
      const response = await fetch('/api/account/phone-otp/request', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ phoneNumber }),
      });

      const data = await response.json();

      if (data.success) {
        setIsNewUser(data.isNewUser);
        setStep('otp');
        setCountdown(60);
      } else {
        setError(data.error || 'Failed to send OTP');
      }
    } catch (err) {
      setError('Network error. Please try again.');
    } finally {
      setLoading(false);
    }
  };

  const handleVerifyOtp = async (e: React.FormEvent) => {
    e.preventDefault();
    setError('');
    setLoading(true);

    try {
      const response = await fetch('/api/account/phone-otp/verify', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ phoneNumber, code: otpCode }),
      });

      const data = await response.json();

      if (data.success) {
        login(data.access_token, data.refresh_token, data.user);
        navigate('/');
      } else {
        setError(data.error || 'Invalid OTP');
      }
    } catch (err) {
      setError('Network error. Please try again.');
    } finally {
      setLoading(false);
    }
  };

  const handleResendOtp = async () => {
    if (countdown > 0) return;
    setError('');
    setLoading(true);

    try {
      const response = await fetch('/api/account/phone-otp/request', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ phoneNumber }),
      });

      const data = await response.json();

      if (data.success) {
        setCountdown(60);
      } else {
        setError(data.error || 'Failed to resend OTP');
      }
    } catch (err) {
      setError('Network error. Please try again.');
    } finally {
      setLoading(false);
    }
  };

  return (
    <div className="min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4">
      <div className="max-w-md w-full space-y-8">
        <div className="text-center">
          <h2 className="text-3xl font-bold text-gray-900">
            {step === 'phone' ? 'ÙˆØ±ÙˆØ¯ Ø¨Ø§ Ø´Ù…Ø§Ø±Ù‡ Ù…ÙˆØ¨Ø§ÛŒÙ„' : 'Ú©Ø¯ ØªØ§ÛŒÛŒØ¯'}
          </h2>
          <p className="mt-2 text-gray-600">
            {step === 'phone' 
              ? 'Ø´Ù…Ø§Ø±Ù‡ Ù…ÙˆØ¨Ø§ÛŒÙ„ Ø®ÙˆØ¯ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯'
              : `Ú©Ø¯ Ø§Ø±Ø³Ø§Ù„ Ø´Ø¯Ù‡ Ø¨Ù‡ ${formatPhoneDisplay(phoneNumber)} Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯`
            }
          </p>
          {isNewUser && step === 'otp' && (
            <p className="mt-2 text-green-600 text-sm">
              ğŸ‰ Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÛŒØ¯ Ø¨Ø±Ø§ÛŒ Ø´Ù…Ø§ Ø§ÛŒØ¬Ø§Ø¯ Ø®ÙˆØ§Ù‡Ø¯ Ø´Ø¯
            </p>
          )}
        </div>

        {error && (
          <div className="bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg">
            {error}
          </div>
        )}

        {step === 'phone' ? (
          <form onSubmit={handleRequestOtp} className="space-y-6">
            <div>
              <label htmlFor="phone" className="block text-sm font-medium text-gray-700">
                Ø´Ù…Ø§Ø±Ù‡ Ù…ÙˆØ¨Ø§ÛŒÙ„
              </label>
              <div className="mt-1 relative">
                <span className="absolute inset-y-0 left-0 pl-3 flex items-center text-gray-500">
                  +968
                </span>
                <input
                  id="phone"
                  type="tel"
                  inputMode="numeric"
                  pattern="[0-9]*"
                  maxLength={8}
                  value={phoneNumber}
                  onChange={(e) => setPhoneNumber(e.target.value.replace(/\D/g, ''))}
                  className="block w-full pl-16 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                  placeholder="92506030"
                  required
                  dir="ltr"
                />
              </div>
            </div>

            <button
              type="submit"
              disabled={loading || phoneNumber.length < 8}
              className="w-full py-3 px-4 border border-transparent rounded-lg text-white bg-purple-600 hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500 disabled:opacity-50 disabled:cursor-not-allowed"
            >
              {loading ? (
                <span className="flex items-center justify-center">
                  <svg className="animate-spin -ml-1 mr-3 h-5 w-5 text-white" fill="none" viewBox="0 0 24 24">
                    <circle className="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" strokeWidth="4" />
                    <path className="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z" />
                  </svg>
                  Ø¯Ø± Ø­Ø§Ù„ Ø§Ø±Ø³Ø§Ù„...
                </span>
              ) : (
                'ğŸ“± Ø¯Ø±ÛŒØ§ÙØª Ú©Ø¯ ØªØ§ÛŒÛŒØ¯'
              )}
            </button>
          </form>
        ) : (
          <form onSubmit={handleVerifyOtp} className="space-y-6">
            <div>
              <label htmlFor="otp" className="block text-sm font-medium text-gray-700">
                Ú©Ø¯ Û¶ Ø±Ù‚Ù…ÛŒ
              </label>
              <input
                id="otp"
                type="text"
                inputMode="numeric"
                pattern="[0-9]*"
                maxLength={6}
                value={otpCode}
                onChange={(e) => setOtpCode(e.target.value.replace(/\D/g, ''))}
                className="mt-1 block w-full px-4 py-3 border border-gray-300 rounded-lg text-center text-2xl tracking-[0.5em] focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                placeholder="------"
                required
                autoFocus
                dir="ltr"
              />
            </div>

            <button
              type="submit"
              disabled={loading || otpCode.length < 6}
              className="w-full py-3 px-4 border border-transparent rounded-lg text-white bg-purple-600 hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500 disabled:opacity-50 disabled:cursor-not-allowed"
            >
              {loading ? (
                <span className="flex items-center justify-center">
                  <svg className="animate-spin -ml-1 mr-3 h-5 w-5 text-white" fill="none" viewBox="0 0 24 24">
                    <circle className="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" strokeWidth="4" />
                    <path className="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z" />
                  </svg>
                  Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø±Ø±Ø³ÛŒ...
                </span>
              ) : (
                'âœ… ØªØ§ÛŒÛŒØ¯ Ùˆ ÙˆØ±ÙˆØ¯'
              )}
            </button>

            <div className="flex items-center justify-between text-sm">
              <button
                type="button"
                onClick={() => setStep('phone')}
                className="text-purple-600 hover:text-purple-500"
              >
                â† ØªØºÛŒÛŒØ± Ø´Ù…Ø§Ø±Ù‡
              </button>
              
              <button
                type="button"
                onClick={handleResendOtp}
                disabled={countdown > 0 || loading}
                className={`${
                  countdown > 0 ? 'text-gray-400' : 'text-purple-600 hover:text-purple-500'
                }`}
              >
                {countdown > 0 ? `Ø§Ø±Ø³Ø§Ù„ Ù…Ø¬Ø¯Ø¯ (${countdown}s)` : 'ğŸ”„ Ø§Ø±Ø³Ø§Ù„ Ù…Ø¬Ø¯Ø¯ Ú©Ø¯'}
              </button>
            </div>
          </form>
        )}

        <div className="text-center text-sm text-gray-500">
          <p>Ú©Ø¯ ØªØ§ÛŒÛŒØ¯ Ø§Ø² Ø·Ø±ÛŒÙ‚ ÙˆØ§ØªØ³â€ŒØ§Ù¾ Ø§Ø±Ø³Ø§Ù„ Ù…ÛŒâ€ŒØ´ÙˆØ¯</p>
          <p className="mt-1">Ø§Ú¯Ø± ÙˆØ§ØªØ³â€ŒØ§Ù¾ Ù†Ø¯Ø§Ø±ÛŒØ¯ØŒ Ø§Ø² Ø±ÙˆØ´â€ŒÙ‡Ø§ÛŒ Ø¯ÛŒÚ¯Ø± Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯</p>
        </div>
      </div>
    </div>
  );
};
```

### 5.2 ØµÙØ­Ù‡ Ø§Ø±Ø³Ø§Ù„ Ù¾ÛŒØ§Ù…/Ø¹Ú©Ø³ ÙˆØ§ØªØ³â€ŒØ§Ù¾ (Ø§Ø¯Ù…ÛŒÙ†)

```tsx
// pages/admin/WhatsAppSend.tsx
import React, { useState } from 'react';
import { useAuth } from '../../hooks/useAuth';

type SendType = 'text' | 'image';

export const WhatsAppSend: React.FC = () => {
  const [sendType, setSendType] = useState<SendType>('text');
  const [phoneNumber, setPhoneNumber] = useState('');
  const [message, setMessage] = useState('');
  const [imageUrl, setImageUrl] = useState('');
  const [caption, setCaption] = useState('');
  const [loading, setLoading] = useState(false);
  const [result, setResult] = useState<{ success: boolean; message: string } | null>(null);
  
  const { token } = useAuth();

  const handleSend = async (e: React.FormEvent) => {
    e.preventDefault();
    setLoading(true);
    setResult(null);

    try {
      const endpoint = sendType === 'text' ? '/api/whatsapp/send' : '/api/whatsapp/send-image';
      const body = sendType === 'text' 
        ? { phoneNumber, message }
        : { phoneNumber, imageUrl, caption: caption || undefined };

      const response = await fetch(endpoint, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'Authorization': `Bearer ${token}`,
        },
        body: JSON.stringify(body),
      });

      const data = await response.json();
      setResult(data);

      if (data.success) {
        // Clear form on success
        setMessage('');
        setImageUrl('');
        setCaption('');
      }
    } catch (err) {
      setResult({ success: false, message: 'Network error' });
    } finally {
      setLoading(false);
    }
  };

  return (
    <div className="max-w-2xl mx-auto p-6">
      <h1 className="text-2xl font-bold mb-6">Ø§Ø±Ø³Ø§Ù„ Ù¾ÛŒØ§Ù… ÙˆØ§ØªØ³â€ŒØ§Ù¾</h1>

      {/* Type Selector */}
      <div className="flex gap-4 mb-6">
        <button
          onClick={() => setSendType('text')}
          className={`flex-1 py-3 px-4 rounded-lg border-2 transition-colors ${
            sendType === 'text'
              ? 'border-purple-500 bg-purple-50 text-purple-700'
              : 'border-gray-200 hover:border-gray-300'
          }`}
        >
          ğŸ’¬ Ù¾ÛŒØ§Ù… Ù…ØªÙ†ÛŒ
        </button>
        <button
          onClick={() => setSendType('image')}
          className={`flex-1 py-3 px-4 rounded-lg border-2 transition-colors ${
            sendType === 'image'
              ? 'border-purple-500 bg-purple-50 text-purple-700'
              : 'border-gray-200 hover:border-gray-300'
          }`}
        >
          ğŸ–¼ï¸ Ø¹Ú©Ø³ Ø¨Ø§ Ú©Ù¾Ø´Ù†
        </button>
      </div>

      {/* Result Message */}
      {result && (
        <div className={`mb-6 p-4 rounded-lg ${
          result.success ? 'bg-green-50 text-green-700' : 'bg-red-50 text-red-700'
        }`}>
          {result.success ? 'âœ…' : 'âŒ'} {result.message}
        </div>
      )}

      <form onSubmit={handleSend} className="space-y-4">
        {/* Phone Number */}
        <div>
          <label className="block text-sm font-medium text-gray-700 mb-1">
            Ø´Ù…Ø§Ø±Ù‡ Ù…ÙˆØ¨Ø§ÛŒÙ„ Ú¯ÛŒØ±Ù†Ø¯Ù‡
          </label>
          <input
            type="tel"
            value={phoneNumber}
            onChange={(e) => setPhoneNumber(e.target.value)}
            className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500"
            placeholder="92506030 ÛŒØ§ 96892506030"
            required
            dir="ltr"
          />
        </div>

        {sendType === 'text' ? (
          /* Text Message */
          <div>
            <label className="block text-sm font-medium text-gray-700 mb-1">
              Ù…ØªÙ† Ù¾ÛŒØ§Ù…
            </label>
            <textarea
              value={message}
              onChange={(e) => setMessage(e.target.value)}
              rows={5}
              className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500"
              placeholder="Ù¾ÛŒØ§Ù… Ø®ÙˆØ¯ Ø±Ø§ Ø¨Ù†ÙˆÛŒØ³ÛŒØ¯..."
              required
            />
            <p className="text-sm text-gray-500 mt-1">
              {message.length}/2000 Ú©Ø§Ø±Ø§Ú©ØªØ±
            </p>
          </div>
        ) : (
          /* Image + Caption */
          <>
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-1">
                Ø¢Ø¯Ø±Ø³ Ø¹Ú©Ø³ (URL)
              </label>
              <input
                type="url"
                value={imageUrl}
                onChange={(e) => setImageUrl(e.target.value)}
                className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500"
                placeholder="https://example.com/image.jpg"
                required
                dir="ltr"
              />
            </div>

            {/* Preview */}
            {imageUrl && (
              <div className="border rounded-lg p-2">
                <p className="text-sm text-gray-500 mb-2">Ù¾ÛŒØ´â€ŒÙ†Ù…Ø§ÛŒØ´:</p>
                <img 
                  src={imageUrl} 
                  alt="Preview" 
                  className="max-h-48 rounded-lg mx-auto"
                  onError={(e) => {
                    (e.target as HTMLImageElement).src = 'https://via.placeholder.com/200?text=Invalid+URL';
                  }}
                />
              </div>
            )}

            <div>
              <label className="block text-sm font-medium text-gray-700 mb-1">
                Ú©Ù¾Ø´Ù† (Ø§Ø®ØªÛŒØ§Ø±ÛŒ)
              </label>
              <textarea
                value={caption}
                onChange={(e) => setCaption(e.target.value)}
                rows={3}
                className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500"
                placeholder="ØªÙˆØ¶ÛŒØ­Ø§Øª Ø¹Ú©Ø³..."
              />
            </div>
          </>
        )}

        <button
          type="submit"
          disabled={loading}
          className="w-full py-3 px-4 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 flex items-center justify-center gap-2"
        >
          {loading ? (
            <>
              <svg className="animate-spin h-5 w-5" fill="none" viewBox="0 0 24 24">
                <circle className="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" strokeWidth="4" />
                <path className="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z" />
              </svg>
              Ø¯Ø± Ø­Ø§Ù„ Ø§Ø±Ø³Ø§Ù„...
            </>
          ) : (
            <>
              <svg className="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"/>
              </svg>
              Ø§Ø±Ø³Ø§Ù„ Ø¨Ø§ ÙˆØ§ØªØ³â€ŒØ§Ù¾
            </>
          )}
        </button>
      </form>
    </div>
  );
};
```

### 5.3 ØµÙØ­Ù‡ ØªÙ†Ø¸ÛŒÙ…Ø§Øª ÙˆØ§ØªØ³â€ŒØ§Ù¾ (Ø§Ø¯Ù…ÛŒÙ†) - Ø¬Ø¯Ø§Ú¯Ø§Ù†Ù‡

```tsx
// pages/admin/WhatsAppNotificationSettings.tsx
import React, { useState, useEffect } from 'react';
import { useAuth } from '../../hooks/useAuth';
import { WhatsAppNotificationSettingsDto, WhatsAppNotificationSettingsResponse } from '../../types';

export const WhatsAppNotificationSettings: React.FC = () => {
  const [settings, setSettings] = useState<WhatsAppNotificationSettingsResponse | null>(null);
  const [loading, setLoading] = useState(true);
  const [saving, setSaving] = useState(false);
  const [error, setError] = useState('');
  const [success, setSuccess] = useState('');
  
  const { token } = useAuth();

  useEffect(() => {
    fetchSettings();
  }, []);

  const fetchSettings = async () => {
    try {
      const response = await fetch('/api/whatsapp-notification-settings', {
        headers: { 'Authorization': `Bearer ${token}` },
      });
      const data = await response.json();
      if (data.success) {
        setSettings(data.data);
      }
    } catch (err) {
      setError('Failed to load settings');
    } finally {
      setLoading(false);
    }
  };

  const handleSave = async () => {
    if (!settings) return;
    setSaving(true);
    setError('');
    setSuccess('');

    try {
      const response = await fetch('/api/whatsapp-notification-settings', {
        method: 'PUT',
        headers: {
          'Content-Type': 'application/json',
          'Authorization': `Bearer ${token}`,
        },
        body: JSON.stringify(settings),
      });

      const result = await response.json();
      if (result.success) {
        setSuccess('ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯');
        setSettings(result.data);
      } else {
        setError('Ø®Ø·Ø§ Ø¯Ø± Ø°Ø®ÛŒØ±Ù‡ ØªÙ†Ø¸ÛŒÙ…Ø§Øª');
      }
    } catch (err) {
      setError('Ø®Ø·Ø§ÛŒ Ø´Ø¨Ú©Ù‡');
    } finally {
      setSaving(false);
    }
  };

  const updateSetting = (key: keyof WhatsAppNotificationSettingsDto, value: any) => {
    if (!settings) return;
    setSettings({ ...settings, [key]: value });
  };

  if (loading) {
    return <div className="p-6 text-center">Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ...</div>;
  }

  if (!settings) {
    return <div className="p-6 text-center text-red-600">Ø®Ø·Ø§ Ø¯Ø± Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ ØªÙ†Ø¸ÛŒÙ…Ø§Øª</div>;
  }

  const renderToggle = (
    label: string, 
    key: keyof WhatsAppNotificationSettingsDto, 
    description?: string
  ) => (
    <div className="flex items-center justify-between py-3 border-b border-gray-100 last:border-0">
      <div>
        <p className="font-medium text-gray-900">{label}</p>
        {description && <p className="text-sm text-gray-500">{description}</p>}
      </div>
      <label className="relative inline-flex items-center cursor-pointer">
        <input
          type="checkbox"
          checked={settings[key] as boolean}
          onChange={(e) => updateSetting(key, e.target.checked)}
          className="sr-only peer"
        />
        <div className="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-green-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-green-600"></div>
      </label>
    </div>
  );

  return (
    <div className="max-w-4xl mx-auto p-6">
      <div className="flex items-center gap-3 mb-6">
        <svg className="w-8 h-8 text-green-600" fill="currentColor" viewBox="0 0 24 24">
          <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"/>
        </svg>
        <h1 className="text-2xl font-bold">ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ù†ÙˆØªÛŒÙÛŒÚ©ÛŒØ´Ù† ÙˆØ§ØªØ³â€ŒØ§Ù¾</h1>
      </div>

      {/* Messages */}
      {error && (
        <div className="mb-4 p-4 bg-red-50 text-red-700 rounded-lg">{error}</div>
      )}
      {success && (
        <div className="mb-4 p-4 bg-green-50 text-green-700 rounded-lg">{success}</div>
      )}

      <div className="space-y-6">
        {/* Master Switch */}
        <div className="bg-white rounded-lg shadow p-6">
          <h2 className="text-lg font-semibold mb-4">ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ú©Ù„ÛŒ</h2>
          {renderToggle('ÙØ¹Ø§Ù„â€ŒØ³Ø§Ø²ÛŒ ÙˆØ§ØªØ³â€ŒØ§Ù¾', 'isEnabled', 'Ú©Ù„ÛŒØ¯ Ø§ØµÙ„ÛŒ Ø¨Ø±Ø§ÛŒ Ù‡Ù…Ù‡ Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§ÛŒ ÙˆØ§ØªØ³â€ŒØ§Ù¾')}
          
          <div className="mt-4 space-y-4">
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-1">
                Ø´Ù…Ø§Ø±Ù‡â€ŒÙ‡Ø§ÛŒ Ø§Ø¯Ù…ÛŒÙ† (Ø¨Ø§ Ú©Ø§Ù…Ø§ Ø¬Ø¯Ø§ Ú©Ù†ÛŒØ¯)
              </label>
              <input
                type="text"
                value={settings.adminNumbers || ''}
                onChange={(e) => updateSetting('adminNumbers', e.target.value)}
                className="w-full px-4 py-2 border border-gray-300 rounded-lg"
                placeholder="96892506030, 96899999999"
                dir="ltr"
              />
            </div>
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-1">
                Ø´Ù…Ø§Ø±Ù‡ Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ
              </label>
              <input
                type="text"
                value={settings.supportNumber || ''}
                onChange={(e) => updateSetting('supportNumber', e.target.value)}
                className="w-full px-4 py-2 border border-gray-300 rounded-lg"
                placeholder="96892506030"
                dir="ltr"
              />
            </div>
          </div>
        </div>

        {/* Customer Notifications */}
        <div className="bg-white rounded-lg shadow p-6">
          <h2 className="text-lg font-semibold mb-4">Ù†ÙˆØªÛŒÙÛŒÚ©ÛŒØ´Ù† Ù…Ø´ØªØ±ÛŒØ§Ù†</h2>
          {renderToggle('Ø«Ø¨Øª Ø³ÙØ§Ø±Ø´', 'customerOrderPlacedEnabled')}
          {renderToggle('ØªØºÛŒÛŒØ± ÙˆØ¶Ø¹ÛŒØª Ø³ÙØ§Ø±Ø´', 'customerOrderStatusChangedEnabled')}
          {renderToggle('ØªØºÛŒÛŒØ± ÙˆØ¶Ø¹ÛŒØª Ù¾Ø±Ø¯Ø§Ø®Øª', 'customerPaymentStatusChangedEnabled')}
          {renderToggle('Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø§Ø±Ø³Ø§Ù„', 'customerShippingUpdateEnabled')}
          {renderToggle('Ù„ØºÙˆ Ø³ÙØ§Ø±Ø´', 'customerOrderCancelledEnabled')}
          {renderToggle('Ø®ÙˆØ´â€ŒØ¢Ù…Ø¯Ú¯ÙˆÛŒÛŒ', 'customerWelcomeEnabled')}
          {renderToggle('ÙˆØ±ÙˆØ¯ Ù…ÙˆÙÙ‚', 'customerLoginSuccessEnabled')}
          {renderToggle('Ø¨Ø§Ø²ÛŒØ§Ø¨ÛŒ Ø±Ù…Ø² Ø¹Ø¨ÙˆØ±', 'customerPasswordResetEnabled')}
          {renderToggle('ØªØºÛŒÛŒØ± Ø±Ù…Ø² Ø¹Ø¨ÙˆØ±', 'customerPasswordChangedEnabled')}
          {renderToggle('Ú©Ø¯ OTP', 'customerOtpEnabled', 'Ø§Ø±Ø³Ø§Ù„ Ú©Ø¯ ÙˆØ±ÙˆØ¯ Ø¨Ø§ ÙˆØ§ØªØ³â€ŒØ§Ù¾')}
        </div>

        {/* Admin Notifications */}
        <div className="bg-white rounded-lg shadow p-6">
          <h2 className="text-lg font-semibold mb-4">Ù†ÙˆØªÛŒÙÛŒÚ©ÛŒØ´Ù† Ø§Ø¯Ù…ÛŒÙ†</h2>
          {renderToggle('Ø³ÙØ§Ø±Ø´ Ø¬Ø¯ÛŒØ¯', 'adminNewOrderEnabled')}
          {renderToggle('Ù¾Ø±Ø¯Ø§Ø®Øª Ø¯Ø±ÛŒØ§ÙØª Ø´Ø¯', 'adminPaymentReceivedEnabled')}
          {renderToggle('ØªØºÛŒÛŒØ± ÙˆØ¶Ø¹ÛŒØª Ø³ÙØ§Ø±Ø´', 'adminOrderStatusChangedEnabled')}
          {renderToggle('Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ú©Ù…', 'adminLowStockEnabled')}
          {renderToggle('Ú©Ø§Ø±Ø¨Ø± Ø¬Ø¯ÛŒØ¯', 'adminNewUserEnabled')}
        </div>
      </div>

      {/* Save Button */}
      <div className="mt-6 flex justify-end">
        <button
          onClick={handleSave}
          disabled={saving}
          className="px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 flex items-center gap-2"
        >
          {saving ? (
            <>
              <svg className="animate-spin h-5 w-5" fill="none" viewBox="0 0 24 24">
                <circle className="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" strokeWidth="4" />
                <path className="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z" />
              </svg>
              Ø¯Ø± Ø­Ø§Ù„ Ø°Ø®ÛŒØ±Ù‡...
            </>
          ) : (
            'ğŸ’¾ Ø°Ø®ÛŒØ±Ù‡ ØªÙ†Ø¸ÛŒÙ…Ø§Øª'
          )}
        </button>
      </div>
    </div>
  );
};
```

---

## 6. Hooks Ø³ÙØ§Ø±Ø´ÛŒ

### 6.1 usePhoneAuth Hook

```typescript
// hooks/usePhoneAuth.ts
import { useState, useCallback } from 'react';
import { useAuth } from './useAuth';

interface UsePhoneAuthReturn {
  step: 'phone' | 'otp';
  phoneNumber: string;
  otpCode: string;
  isNewUser: boolean;
  loading: boolean;
  error: string | null;
  countdown: number;
  setPhoneNumber: (phone: string) => void;
  setOtpCode: (code: string) => void;
  requestOtp: () => Promise<boolean>;
  verifyOtp: () => Promise<boolean>;
  resendOtp: () => Promise<boolean>;
  reset: () => void;
}

export const usePhoneAuth = (): UsePhoneAuthReturn => {
  const [step, setStep] = useState<'phone' | 'otp'>('phone');
  const [phoneNumber, setPhoneNumber] = useState('');
  const [otpCode, setOtpCode] = useState('');
  const [isNewUser, setIsNewUser] = useState(false);
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState<string | null>(null);
  const [countdown, setCountdown] = useState(0);

  const { login } = useAuth();

  const startCountdown = useCallback(() => {
    setCountdown(60);
    const interval = setInterval(() => {
      setCountdown((prev) => {
        if (prev <= 1) {
          clearInterval(interval);
          return 0;
        }
        return prev - 1;
      });
    }, 1000);
  }, []);

  const requestOtp = useCallback(async (): Promise<boolean> => {
    setLoading(true);
    setError(null);

    try {
      const response = await fetch('/api/account/phone-otp/request', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ phoneNumber }),
      });

      const data = await response.json();

      if (data.success) {
        setIsNewUser(data.isNewUser);
        setStep('otp');
        startCountdown();
        return true;
      } else {
        setError(data.error);
        return false;
      }
    } catch (err) {
      setError('Network error');
      return false;
    } finally {
      setLoading(false);
    }
  }, [phoneNumber, startCountdown]);

  const verifyOtp = useCallback(async (): Promise<boolean> => {
    setLoading(true);
    setError(null);

    try {
      const response = await fetch('/api/account/phone-otp/verify', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ phoneNumber, code: otpCode }),
      });

      const data = await response.json();

      if (data.success) {
        login(data.access_token, data.refresh_token, data.user);
        return true;
      } else {
        setError(data.error);
        return false;
      }
    } catch (err) {
      setError('Network error');
      return false;
    } finally {
      setLoading(false);
    }
  }, [phoneNumber, otpCode, login]);

  const resendOtp = useCallback(async (): Promise<boolean> => {
    if (countdown > 0) return false;
    return requestOtp();
  }, [countdown, requestOtp]);

  const reset = useCallback(() => {
    setStep('phone');
    setPhoneNumber('');
    setOtpCode('');
    setIsNewUser(false);
    setError(null);
    setCountdown(0);
  }, []);

  return {
    step,
    phoneNumber,
    otpCode,
    isNewUser,
    loading,
    error,
    countdown,
    setPhoneNumber,
    setOtpCode,
    requestOtp,
    verifyOtp,
    resendOtp,
    reset,
  };
};
```

### 6.2 useWhatsAppSend Hook

```typescript
// hooks/useWhatsAppSend.ts
import { useState, useCallback } from 'react';
import { useAuth } from './useAuth';

interface SendTextParams {
  phoneNumber: string;
  message: string;
}

interface SendImageParams {
  phoneNumber: string;
  imageUrl: string;
  caption?: string;
}

interface UseWhatsAppSendReturn {
  loading: boolean;
  error: string | null;
  success: boolean;
  sendText: (params: SendTextParams) => Promise<boolean>;
  sendImage: (params: SendImageParams) => Promise<boolean>;
  reset: () => void;
}

export const useWhatsAppSend = (): UseWhatsAppSendReturn => {
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState<string | null>(null);
  const [success, setSuccess] = useState(false);

  const { token } = useAuth();

  const sendText = useCallback(async (params: SendTextParams): Promise<boolean> => {
    setLoading(true);
    setError(null);
    setSuccess(false);

    try {
      const response = await fetch('/api/whatsapp/send', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'Authorization': `Bearer ${token}`,
        },
        body: JSON.stringify(params),
      });

      const data = await response.json();

      if (data.success) {
        setSuccess(true);
        return true;
      } else {
        setError(data.message);
        return false;
      }
    } catch (err) {
      setError('Network error');
      return false;
    } finally {
      setLoading(false);
    }
  }, [token]);

  const sendImage = useCallback(async (params: SendImageParams): Promise<boolean> => {
    setLoading(true);
    setError(null);
    setSuccess(false);

    try {
      const response = await fetch('/api/whatsapp/send-image', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'Authorization': `Bearer ${token}`,
        },
        body: JSON.stringify(params),
      });

      const data = await response.json();

      if (data.success) {
        setSuccess(true);
        return true;
      } else {
        setError(data.message);
        return false;
      }
    } catch (err) {
      setError('Network error');
      return false;
    } finally {
      setLoading(false);
    }
  }, [token]);

  const reset = useCallback(() => {
    setError(null);
    setSuccess(false);
  }, []);

  return {
    loading,
    error,
    success,
    sendText,
    sendImage,
    reset,
  };
};
```

---

## 7. Ù…Ø¯ÛŒØ±ÛŒØª Ø®Ø·Ø§Ù‡Ø§

### Ø®Ø·Ø§Ù‡Ø§ÛŒ Ø±Ø§ÛŒØ¬ OTP

| Ú©Ø¯ Ø®Ø·Ø§ | Ù¾ÛŒØ§Ù… | Ø±Ø§Ù‡â€ŒØ­Ù„ |
|--------|------|--------|
| `Invalid phone number` | Ø´Ù…Ø§Ø±Ù‡ Ù†Ø§Ù…Ø¹ØªØ¨Ø± | ÙØ±Ù…Øª ØµØ­ÛŒØ­: 8 Ø±Ù‚Ù… Ø¹Ù…Ø§Ù† ÛŒØ§ Ø¨Ø§ 968 |
| `Please wait X seconds` | Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ø²ÙˆØ¯Ù‡Ù†Ú¯Ø§Ù… | countdown Ù†Ø´Ø§Ù† Ø¯Ù‡ÛŒØ¯ |
| `User is inactive` | Ú©Ø§Ø±Ø¨Ø± ØºÛŒØ±ÙØ¹Ø§Ù„ | ØªÙ…Ø§Ø³ Ø¨Ø§ Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ |
| `OTP expired or not found` | Ú©Ø¯ Ù…Ù†Ù‚Ø¶ÛŒ | Ø¯Ú©Ù…Ù‡ Ø§Ø±Ø³Ø§Ù„ Ù…Ø¬Ø¯Ø¯ |
| `Invalid OTP. X attempts remaining` | Ú©Ø¯ Ø§Ø´ØªØ¨Ø§Ù‡ | ØªØ¹Ø¯Ø§Ø¯ ØªÙ„Ø§Ø´ Ù†Ù…Ø§ÛŒØ´ Ø¯Ù‡ÛŒØ¯ |
| `Too many attempts` | Ø¨ÛŒØ´ Ø§Ø² Ø­Ø¯ ØªÙ„Ø§Ø´ | Ø¯Ø±Ø®ÙˆØ§Ø³Øª OTP Ø¬Ø¯ÛŒØ¯ |
| `Failed to send OTP via WhatsApp` | Ø®Ø·Ø§ÛŒ Ø§Ø±Ø³Ø§Ù„ | Ø¨Ø±Ø±Ø³ÛŒ ÙˆØ§ØªØ³â€ŒØ§Ù¾ Ú©Ø§Ø±Ø¨Ø± |

### Ù†Ù…ÙˆÙ†Ù‡ Ù…Ø¯ÛŒØ±ÛŒØª Ø®Ø·Ø§

```typescript
const handleOtpError = (error: string) => {
  if (error.includes('wait')) {
    // Extract seconds from message
    const match = error.match(/(\d+)/);
    if (match) {
      setCountdown(parseInt(match[1]));
    }
    return 'Ù„Ø·ÙØ§Ù‹ Ú†Ù†Ø¯ Ù„Ø­Ø¸Ù‡ ØµØ¨Ø± Ú©Ù†ÛŒØ¯';
  }
  
  if (error.includes('Invalid OTP')) {
    const match = error.match(/(\d+) attempts/);
    const remaining = match ? parseInt(match[1]) : 0;
    return `Ú©Ø¯ Ø§Ø´ØªØ¨Ø§Ù‡ Ø§Ø³Øª. ${remaining} ØªÙ„Ø§Ø´ Ø¨Ø§Ù‚ÛŒ Ù…Ø§Ù†Ø¯Ù‡`;
  }
  
  if (error.includes('expired')) {
    return 'Ú©Ø¯ Ù…Ù†Ù‚Ø¶ÛŒ Ø´Ø¯Ù‡. Ù„Ø·ÙØ§Ù‹ Ú©Ø¯ Ø¬Ø¯ÛŒØ¯ Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ú©Ù†ÛŒØ¯';
  }
  
  if (error.includes('Too many')) {
    return 'ØªØ¹Ø¯Ø§Ø¯ ØªÙ„Ø§Ø´ Ø¨ÛŒØ´ Ø§Ø² Ø­Ø¯ Ù…Ø¬Ø§Ø². Ù„Ø·ÙØ§Ù‹ Ú©Ø¯ Ø¬Ø¯ÛŒØ¯ Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ú©Ù†ÛŒØ¯';
  }
  
  return error;
};
```

---

## Ø®Ù„Ø§ØµÙ‡ API Endpoints

| Method | Endpoint | Auth | Description |
|--------|----------|------|-------------|
| `POST` | `/api/account/phone-otp/request` | âŒ | Ø¯Ø±Ø®ÙˆØ§Ø³Øª OTP |
| `POST` | `/api/account/phone-otp/verify` | âŒ | ØªØ§ÛŒÛŒØ¯ OTP Ùˆ ÙˆØ±ÙˆØ¯ |
| `POST` | `/api/whatsapp/send` | âœ… Admin | Ø§Ø±Ø³Ø§Ù„ Ù¾ÛŒØ§Ù… Ù…ØªÙ†ÛŒ |
| `POST` | `/api/whatsapp/send-image` | âœ… Admin | Ø§Ø±Ø³Ø§Ù„ Ø¹Ú©Ø³ Ø¨Ø§ Ú©Ù¾Ø´Ù† |
| `GET` | `/api/whatsapp-notification-settings` | âœ… Admin | Ø¯Ø±ÛŒØ§ÙØª ØªÙ†Ø¸ÛŒÙ…Ø§Øª ÙˆØ§ØªØ³â€ŒØ§Ù¾ |
| `PUT` | `/api/whatsapp-notification-settings` | âœ… Admin | Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ ØªÙ†Ø¸ÛŒÙ…Ø§Øª ÙˆØ§ØªØ³â€ŒØ§Ù¾ |
| `GET` | `/api/email-notification-settings` | âœ… Admin | Ø¯Ø±ÛŒØ§ÙØª ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø§ÛŒÙ…ÛŒÙ„ |
| `PUT` | `/api/email-notification-settings` | âœ… Admin | Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø§ÛŒÙ…ÛŒÙ„ |

---

## Ù†Ú©Ø§Øª Ù…Ù‡Ù…

1. **Ø§Ù…Ù†ÛŒØª**: Ù‡Ø±Ú¯Ø² OTP Ø±Ø§ Ø¯Ø± localStorage Ø°Ø®ÛŒØ±Ù‡ Ù†Ú©Ù†ÛŒØ¯
2. **UX**: Ù‡Ù…ÛŒØ´Ù‡ countdown Ø¨Ø±Ø§ÛŒ Ø§Ø±Ø³Ø§Ù„ Ù…Ø¬Ø¯Ø¯ Ù†Ù…Ø§ÛŒØ´ Ø¯Ù‡ÛŒØ¯
3. **Validation**: Ø´Ù…Ø§Ø±Ù‡ Ù…ÙˆØ¨Ø§ÛŒÙ„ Ø±Ø§ Ù‚Ø¨Ù„ Ø§Ø² Ø§Ø±Ø³Ø§Ù„ validate Ú©Ù†ÛŒØ¯
4. **Error Handling**: Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§ÛŒ Ø®Ø·Ø§ Ø±Ø§ ÙØ§Ø±Ø³ÛŒ Ùˆ Ú©Ø§Ø±Ø¨Ø±Ù¾Ø³Ù†Ø¯ Ù†Ù…Ø§ÛŒØ´ Ø¯Ù‡ÛŒØ¯
5. **Auto-focus**: Ø¨Ø¹Ø¯ Ø§Ø² Ø§Ø±Ø³Ø§Ù„ OTPØŒ ÙÙˆÚ©ÙˆØ³ Ø±Ø§ Ø¨Ù‡ ÙÛŒÙ„Ø¯ Ú©Ø¯ Ù…Ù†ØªÙ‚Ù„ Ú©Ù†ÛŒØ¯
6. **RTL**: Ø¨Ø±Ø§ÛŒ ÙÛŒÙ„Ø¯Ù‡Ø§ÛŒ Ø´Ù…Ø§Ø±Ù‡ Ùˆ Ú©Ø¯ØŒ `dir="ltr"` Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯
